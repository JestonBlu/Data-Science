---
output: html_document
---

## **Parameter Estimation through Bootstrap**

---

##### **Techniques Used**
  * Bootstrap Sampling

---

```{r a1, warning=FALSE, message=FALSE, comment=NA, fig.width=8, fig.height=3}

## Create a mixed Distribution
set.seed(10)
y1 = rnorm(5, 5, 3); y2 = rnorm(10, 10, 1); y3 = rnorm(5, 20, 5)
Y = c(y1, y2, y3)

par(mfrow = c(1, 2))
hist(Y, breaks = 10)
plot(density(Y))

par(mfrow = c(1,1))

## Is Y part of a normal distribution?
shapiro.test(Y)

## Bootstrap simulation to estimate the mean
X = data.frame()

## Draw 10k random samples from Y and calculate the mean
for (i in 1:10000) {
  x = sample(Y, length(Y), replace = TRUE)
  mu.x = mean(x)
  sd.x = sd(x)
  X = rbind(X, cbind(mu.x, sd.x))
}

par(mfrow = c(1, 2))
hist(X$mu.x, breaks = 50, main = "Histogram of X_Bar")
hist(X$sd.x, breaks = 50, main = "Histogram of X_SD")

## We can see that a sample of the repeated sampling of the boostrap creates a 
## normal distribution of sample means although we do not need to use a formal test
shapiro.test(sample(X$mu.x, 1000))

## Mean Comparions
mean(X$mu.x); mean(Y)

## Standard Deviation Comparisons
mean(X$sd.x); sd(Y)

## What is the probability that the true mean is greater than the original sample mean
length(which(X$mu.x > mean(Y))) / 10000

## What is the probability that the true mean is greater than 13?
length(which(X$mu.x > 13)) / 10000

## What is a 95% confidence interval for mu?
mean(X$mu.x) + c(-1, 1) * qt(1 - .05/2, 9999) * sd(X$mu.x)/sqrt(10000)

```
