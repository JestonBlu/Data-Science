---
output: 
  html_document
---

## **Building Maps with choropleth and ggplot**

---

**Data: Census 2000, number of jobs by industry by county**

```{r a, warning=FALSE, message=FALSE, comment=NA, R.options=list(width=100)}

library(choroplethr)
library(choroplethrMaps)
library(ggplot2)
library(gridExtra)

employment = read.csv("census_2000_employment.csv")

head(employment)

```


```{r b, warning=FALSE, message=FALSE, comment=NA, R.options=list(width=100), fig.width=9, fig.height=7}

farming = data.frame(
  region = employment$STCOU,
  value = employment$Farming
  )

g1 = county_choropleth(farming, 
                       title = "Farming Employment", 
                       legend = "Jobs")

employment$Total = rowSums(employment[, 2:10])

farming = data.frame(
  region = employment$STCOU,
  value = (employment$Farming) / (employment$Total - employment$Farming)
  )

g2 = county_choropleth(farming, 
                       title = "Ratio of Farming to non-Farming Employment", 
                       legend = "Ratio")

grid.arrange(g1, g2, nrow = 2)

```

<br>

You can also change the color and create custom map objects

```{r c, warning=FALSE, message=FALSE, comment=NA, R.options=list(width=100), fig.width=9, fig.height=5}

choro = CountyChoropleth$new(farming)
choro$title = "Southern Farming"
choro$set_num_colors(1)
choro$ggplot_scale = scale_fill_gradientn("Ratio", colors = c("#F6EAE1", "darkgreen"))
choro$set_zoom(c("texas", "louisiana", "mississippi", "alabama", "georgia", "arkansas", 
                 "tennessee", "south carolina", "florida", "oklahoma", "north carolina"))
choro$render()


```
















