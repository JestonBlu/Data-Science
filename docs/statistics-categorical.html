<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
Data Science and Statistics
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="statistics-categorical.html"><a href="statistics-categorical.html"><i class="fa fa-check"></i>Statistics: Categorical</a><ul>
<li class="chapter" data-level="0.1" data-path="statistics-categorical.html"><a href="statistics-categorical.html#contingency-tables"><i class="fa fa-check"></i><b>0.1</b> Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="statistics-categorical.html"><a href="statistics-categorical.html#logistic-regression"><i class="fa fa-check"></i>Logistic Regression</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics-categorical" class="section level1 unnumbered">
<h1>Statistics: Categorical</h1>
<div id="contingency-tables" class="section level2">
<h2><span class="header-section-number">0.1</span> Contingency Tables</h2>
<table style="width:83%;">
<caption>Data for applicant entrance for 6 departments</caption>
<colgroup>
<col width="18%" />
<col width="15%" />
<col width="13%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Department</th>
<th align="center">Male.Yes</th>
<th align="center">Male.No</th>
<th align="center">Female.Yes</th>
<th align="center">Female.No</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">512</td>
<td align="center">313</td>
<td align="center">89</td>
<td align="center">19</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">353</td>
<td align="center">207</td>
<td align="center">17</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">120</td>
<td align="center">205</td>
<td align="center">202</td>
<td align="center">391</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">138</td>
<td align="center">279</td>
<td align="center">131</td>
<td align="center">244</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">53</td>
<td align="center">138</td>
<td align="center">94</td>
<td align="center">299</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">22</td>
<td align="center">351</td>
<td align="center">24</td>
<td align="center">317</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dta<span class="op">$</span>OR =<span class="st"> </span><span class="kw">with</span>(dta, (Male.Yes <span class="op">*</span><span class="st"> </span>Female.No) <span class="op">/</span><span class="st"> </span>(Male.No <span class="op">*</span><span class="st"> </span>Female.Yes))
dta<span class="op">$</span>se =<span class="st"> </span><span class="kw">with</span>(dta, (<span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span>Male.Yes <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>Female.No <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>Male.No <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>Female.Yes)))
dta<span class="op">$</span>Conf.lwr =<span class="st"> </span><span class="kw">with</span>(dta, OR <span class="op">-</span><span class="st"> </span>(<span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se))
dta<span class="op">$</span>Conf.Upr =<span class="st"> </span><span class="kw">with</span>(dta, OR <span class="op">+</span><span class="st"> </span>(<span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se))

<span class="kw">pandoc.table</span>(dta, <span class="dt">split.tables =</span> <span class="ot">Inf</span>)</code></pre></div>
<table>
<colgroup>
<col width="13%" />
<col width="11%" />
<col width="10%" />
<col width="13%" />
<col width="12%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Department</th>
<th align="center">Male.Yes</th>
<th align="center">Male.No</th>
<th align="center">Female.Yes</th>
<th align="center">Female.No</th>
<th align="center">OR</th>
<th align="center">se</th>
<th align="center">Conf.lwr</th>
<th align="center">Conf.Upr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">512</td>
<td align="center">313</td>
<td align="center">89</td>
<td align="center">19</td>
<td align="center">0.3492</td>
<td align="center">0.2627</td>
<td align="center">-0.1657</td>
<td align="center">0.8641</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">353</td>
<td align="center">207</td>
<td align="center">17</td>
<td align="center">8</td>
<td align="center">0.8025</td>
<td align="center">0.4376</td>
<td align="center">-0.05518</td>
<td align="center">1.66</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">120</td>
<td align="center">205</td>
<td align="center">202</td>
<td align="center">391</td>
<td align="center">1.133</td>
<td align="center">0.1439</td>
<td align="center">0.8509</td>
<td align="center">1.415</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">138</td>
<td align="center">279</td>
<td align="center">131</td>
<td align="center">244</td>
<td align="center">0.9213</td>
<td align="center">0.1502</td>
<td align="center">0.6269</td>
<td align="center">1.216</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">53</td>
<td align="center">138</td>
<td align="center">94</td>
<td align="center">299</td>
<td align="center">1.222</td>
<td align="center">0.2002</td>
<td align="center">0.8292</td>
<td align="center">1.614</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">22</td>
<td align="center">351</td>
<td align="center">24</td>
<td align="center">317</td>
<td align="center">0.8279</td>
<td align="center">0.3052</td>
<td align="center">0.2298</td>
<td align="center">1.426</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">marginal =<span class="st"> </span><span class="kw">colSums</span>(dta[, <span class="dv">2</span><span class="op">:</span><span class="dv">5</span>])
OR =<span class="st"> </span>(marginal[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>marginal[<span class="dv">4</span>]) <span class="op">/</span><span class="st"> </span>(marginal[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>marginal[<span class="dv">3</span>])
se =<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span>marginal[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>marginal[<span class="dv">4</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>marginal[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>marginal[<span class="dv">3</span>])

## Confidence Interval for the Marginal OR
OR <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se</code></pre></div>
<pre><code>[1] 1.71585 1.96631</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DescTools)
<span class="kw">library</span>(lawstat)

dta =<span class="st"> </span><span class="kw">xtabs</span>(freq <span class="op">~</span><span class="st"> </span>.,
            <span class="kw">cbind</span>(<span class="kw">expand.grid</span>(<span class="dt">Gender =</span> <span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>),
                              <span class="dt">Entrace =</span> <span class="kw">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>),
                              <span class="dt">Department =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>)),
                  <span class="dt">freq =</span>  <span class="kw">c</span>(<span class="dv">512</span>, <span class="dv">89</span>, <span class="dv">313</span>, <span class="dv">19</span>, <span class="dv">353</span>, <span class="dv">17</span>, <span class="dv">207</span>, <span class="dv">8</span>, <span class="dv">120</span>, <span class="dv">202</span>, <span class="dv">205</span>, <span class="dv">391</span>,
                            <span class="dv">138</span>, <span class="dv">131</span>, <span class="dv">279</span>, <span class="dv">244</span>, <span class="dv">53</span>, <span class="dv">94</span>, <span class="dv">138</span>, <span class="dv">299</span>, <span class="dv">22</span>, <span class="dv">24</span>, <span class="dv">351</span>, <span class="dv">317</span>)
                  )
            )

## Ho: OR = 1, Ha: OR &gt; 1
<span class="kw">BreslowDayTest</span>(dta, <span class="dt">OR =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>
    Breslow-Day test on Homogeneity of Odds Ratios

data:  dta
X-squared = 19.938, df = 5, p-value = 0.001283</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Ho: OR_1 = OR_2 = OR_3 = OR_4 = OR_5 = OR_6, Ha: At least one set of OR are not equal
<span class="kw">cmh.test</span>(dta)</code></pre></div>
<pre><code>
    Cochran-Mantel-Haenszel Chi-square Test

data:  dta
CMH statistic = 1.52460, df = 1.00000, p-value = 0.21692, MH
Estimate = 0.90470, Pooled Odd Ratio = 1.84110, Odd Ratio of level
1 = 0.34921, Odd Ratio of level 2 = 0.80250, Odd Ratio of level 3
= 1.13310, Odd Ratio of level 4 = 0.92128, Odd Ratio of level 5 =
1.22160, Odd Ratio of level 6 = 0.82787</code></pre>
<p>Based on the Breslow Day test we reject the null hypothesis that the odds ratios are equal to 1. The CMH test fails to reject that gender and entrance are independent.</p>

</div>
<div id="logistic-regression" class="section level2 unnumbered">
<h2>Logistic Regression</h2>
<hr />
<p><strong>Data Background</strong></p>
<p>NAME: Prostate Cancer Study (PCS.DATA) SIZE: 380 observations, 9 variables</p>
<p>SOURCE: Hosmer and Lemeshow (2000) Applied Logistic Regression: Second Edition. These data are copyrighted by John Wiley &amp; Sons Inc. and must be acknowledged and used accordingly.</p>
<p>DESCRIPTIVE ABSTRACT:</p>
<p>These data are described in Section 1.6.3 page 25, of the source text.</p>
<p>LIST OF VARIABLES:</p>
<p>1 Identification Code: 1 - 380 2 Tumor Penetration of Prostatic Capsule: 0 = No Penetration, 1 = Penetration 3 Age: Years 4 Race: 1= White, 2 = Black 5 Results of the Digital Rectal Exam: 1 = No Nodule, 2 = Unilobar Nodule (Left), 3 = Unilobar Nodule (Right), 4 = Bilobar Nodule 6 Detection of Capsular Involvement in Rectal Exam: 1 = No, 2 = Yes 7 Prostatic Specific Antigen Value: mg/ml 8 Tumor Volume Obtained from Ultrasound: cm3 9 Total Gleason Score: 0 - 10</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(popbio)
<span class="kw">library</span>(Deducer)

dta =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Statistics/Categorical/data/pros.csv&quot;</span>)

<span class="kw">head</span>(dta)</code></pre></div>
<pre><code>  ID CAPSULE AGE RACE DPROS DCAPS  PSA  VOL GLEASON
1  1       0  65    1     2     1  1.4  0.0       6
2  2       0  72    1     3     2  6.7  0.0       7
3  3       0  70    1     1     2  4.9  0.0       6
4  4       0  76    2     2     1 51.2 20.0       7
5  5       0  69    1     1     1 12.3 55.9       6
6  6       1  71    1     3     2  3.3  0.0       8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mdl =<span class="st"> </span><span class="kw">glm</span>(CAPSULE <span class="op">~</span><span class="st"> </span>AGE <span class="op">+</span><span class="st"> </span>RACE <span class="op">+</span><span class="st"> </span>DPROS <span class="op">+</span><span class="st"> </span>DCAPS <span class="op">+</span><span class="st"> </span>PSA <span class="op">+</span><span class="st"> </span>VOL <span class="op">+</span><span class="st"> </span>GLEASON,
          <span class="dt">family =</span> <span class="kw">binomial</span>(), <span class="dt">data =</span> dta)

<span class="kw">summary</span>(mdl)</code></pre></div>
<pre><code>
Call:
glm(formula = CAPSULE ~ AGE + RACE + DPROS + DCAPS + PSA + VOL + 
    GLEASON, family = binomial(), data = dta)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4058  -0.7772  -0.4416   0.9019   2.3771  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -6.915650   1.728754  -4.000 6.32e-05 ***
AGE         -0.015825   0.019517  -0.811  0.41745    
RACE        -0.695258   0.476106  -1.460  0.14421    
DPROS        0.551597   0.136545   4.040 5.35e-05 ***
DCAPS        0.479916   0.463728   1.035  0.30071    
PSA          0.027196   0.009922   2.741  0.00613 ** 
VOL         -0.010840   0.007753  -1.398  0.16204    
GLEASON      0.972442   0.167259   5.814 6.10e-09 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 506.59  on 375  degrees of freedom
Residual deviance: 377.31  on 368  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 393.31

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">logi.hist.plot</span>(<span class="kw">sqrt</span>(dta<span class="op">$</span>PSA), dta<span class="op">$</span>CAPSULE, <span class="dt">logi.mod =</span> <span class="dv">1</span>, <span class="dt">boxp =</span> <span class="ot">FALSE</span>, <span class="dt">notch =</span> <span class="ot">FALSE</span>,
               <span class="dt">main =</span> <span class="st">&quot;Logistic Regression plot for PSA&quot;</span>,
               <span class="dt">xlab =</span> <span class="st">&quot;PSA&quot;</span>)</code></pre></div>
<p><img src="datascience_files/figure-html/lg01-1.png" width="864" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rocplot</span>(mdl)</code></pre></div>
<p><img src="datascience_files/figure-html/lg01-2.png" width="864" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>


<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
