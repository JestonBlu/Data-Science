<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="" />
<meta property="og:type" content="book" />








<meta name="description" content="">

<title></title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#welcome">Welcome</a></li>
<li class="has-sub"><a href="statistics-categorical.html#statistics-categorical">Statistics: Categorical</a><ul>
<li><a href="contingency-tables.html#contingency-tables">Contingency Tables</a></li>
<li><a href="logistic-regression.html#logistic-regression">Logistic Regression</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="contingency-tables" class="section level2 unnumbered">
<h2>Contingency Tables</h2>
<table style="width:83%;">
<caption>Data for applicant entrance for 6 departments</caption>
<colgroup>
<col width="18%" />
<col width="15%" />
<col width="13%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Department</th>
<th align="center">Male.Yes</th>
<th align="center">Male.No</th>
<th align="center">Female.Yes</th>
<th align="center">Female.No</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">512</td>
<td align="center">313</td>
<td align="center">89</td>
<td align="center">19</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">353</td>
<td align="center">207</td>
<td align="center">17</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">120</td>
<td align="center">205</td>
<td align="center">202</td>
<td align="center">391</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">138</td>
<td align="center">279</td>
<td align="center">131</td>
<td align="center">244</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">53</td>
<td align="center">138</td>
<td align="center">94</td>
<td align="center">299</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">22</td>
<td align="center">351</td>
<td align="center">24</td>
<td align="center">317</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dta<span class="op">$</span>OR =<span class="st"> </span><span class="kw">with</span>(dta, (Male.Yes <span class="op">*</span><span class="st"> </span>Female.No) <span class="op">/</span><span class="st"> </span>(Male.No <span class="op">*</span><span class="st"> </span>Female.Yes))
dta<span class="op">$</span>se =<span class="st"> </span><span class="kw">with</span>(dta, (<span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span>Male.Yes <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>Female.No <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>Male.No <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>Female.Yes)))
dta<span class="op">$</span>Conf.lwr =<span class="st"> </span><span class="kw">with</span>(dta, OR <span class="op">-</span><span class="st"> </span>(<span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se))
dta<span class="op">$</span>Conf.Upr =<span class="st"> </span><span class="kw">with</span>(dta, OR <span class="op">+</span><span class="st"> </span>(<span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se))

<span class="kw">pandoc.table</span>(dta, <span class="dt">split.tables =</span> <span class="ot">Inf</span>)</code></pre></div>
<table>
<colgroup>
<col width="13%" />
<col width="11%" />
<col width="10%" />
<col width="13%" />
<col width="12%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Department</th>
<th align="center">Male.Yes</th>
<th align="center">Male.No</th>
<th align="center">Female.Yes</th>
<th align="center">Female.No</th>
<th align="center">OR</th>
<th align="center">se</th>
<th align="center">Conf.lwr</th>
<th align="center">Conf.Upr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">512</td>
<td align="center">313</td>
<td align="center">89</td>
<td align="center">19</td>
<td align="center">0.3492</td>
<td align="center">0.2627</td>
<td align="center">-0.1657</td>
<td align="center">0.8641</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">353</td>
<td align="center">207</td>
<td align="center">17</td>
<td align="center">8</td>
<td align="center">0.8025</td>
<td align="center">0.4376</td>
<td align="center">-0.05518</td>
<td align="center">1.66</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">120</td>
<td align="center">205</td>
<td align="center">202</td>
<td align="center">391</td>
<td align="center">1.133</td>
<td align="center">0.1439</td>
<td align="center">0.8509</td>
<td align="center">1.415</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">138</td>
<td align="center">279</td>
<td align="center">131</td>
<td align="center">244</td>
<td align="center">0.9213</td>
<td align="center">0.1502</td>
<td align="center">0.6269</td>
<td align="center">1.216</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">53</td>
<td align="center">138</td>
<td align="center">94</td>
<td align="center">299</td>
<td align="center">1.222</td>
<td align="center">0.2002</td>
<td align="center">0.8292</td>
<td align="center">1.614</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">22</td>
<td align="center">351</td>
<td align="center">24</td>
<td align="center">317</td>
<td align="center">0.8279</td>
<td align="center">0.3052</td>
<td align="center">0.2298</td>
<td align="center">1.426</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">marginal =<span class="st"> </span><span class="kw">colSums</span>(dta[, <span class="dv">2</span><span class="op">:</span><span class="dv">5</span>])
OR =<span class="st"> </span>(marginal[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>marginal[<span class="dv">4</span>]) <span class="op">/</span><span class="st"> </span>(marginal[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>marginal[<span class="dv">3</span>])
se =<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span>marginal[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>marginal[<span class="dv">4</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>marginal[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>marginal[<span class="dv">3</span>])

## Confidence Interval for the Marginal OR
OR <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se</code></pre></div>
<pre><code>[1] 1.71585 1.96631</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DescTools)
<span class="kw">library</span>(lawstat)

dta =<span class="st"> </span><span class="kw">xtabs</span>(freq <span class="op">~</span><span class="st"> </span>.,
            <span class="kw">cbind</span>(<span class="kw">expand.grid</span>(<span class="dt">Gender =</span> <span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>),
                              <span class="dt">Entrace =</span> <span class="kw">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>),
                              <span class="dt">Department =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>)),
                  <span class="dt">freq =</span>  <span class="kw">c</span>(<span class="dv">512</span>, <span class="dv">89</span>, <span class="dv">313</span>, <span class="dv">19</span>, <span class="dv">353</span>, <span class="dv">17</span>, <span class="dv">207</span>, <span class="dv">8</span>, <span class="dv">120</span>, <span class="dv">202</span>, <span class="dv">205</span>, <span class="dv">391</span>,
                            <span class="dv">138</span>, <span class="dv">131</span>, <span class="dv">279</span>, <span class="dv">244</span>, <span class="dv">53</span>, <span class="dv">94</span>, <span class="dv">138</span>, <span class="dv">299</span>, <span class="dv">22</span>, <span class="dv">24</span>, <span class="dv">351</span>, <span class="dv">317</span>)
                  )
            )

## Ho: OR = 1, Ha: OR &gt; 1
<span class="kw">BreslowDayTest</span>(dta, <span class="dt">OR =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>
    Breslow-Day test on Homogeneity of Odds Ratios

data:  dta
X-squared = 19.938, df = 5, p-value = 0.001283</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Ho: OR_1 = OR_2 = OR_3 = OR_4 = OR_5 = OR_6, Ha: At least one set of OR are not equal
<span class="kw">cmh.test</span>(dta)</code></pre></div>
<pre><code>
    Cochran-Mantel-Haenszel Chi-square Test

data:  dta
CMH statistic = 1.52460, df = 1.00000, p-value = 0.21692, MH
Estimate = 0.90470, Pooled Odd Ratio = 1.84110, Odd Ratio of level
1 = 0.34921, Odd Ratio of level 2 = 0.80250, Odd Ratio of level 3
= 1.13310, Odd Ratio of level 4 = 0.92128, Odd Ratio of level 5 =
1.22160, Odd Ratio of level 6 = 0.82787</code></pre>
<p>Based on the Breslow Day test we reject the null hypothesis that the odds ratios are equal to 1. The CMH test fails to reject that gender and entrance are independent.</p>

</div>
<p style="text-align: center;">
<a href="statistics-categorical.html"><button class="btn btn-default">Previous</button></a>
<a href="logistic-regression.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
