<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="me.html">


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>My Stuff</a></li>
<li class="chapter" data-level="" data-path="me.html"><a href="me.html"><i class="fa fa-check"></i>Me</a></li>
<li class="chapter" data-level="" data-path="contingency-tables.html"><a href="contingency-tables.html"><i class="fa fa-check"></i>Contingency Tables</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="contingency-tables" class="section level1 unnumbered">
<h1>Contingency Tables</h1>
<hr />
<table style="width:83%;">
<caption>Data for applicant entrance for 6 departments</caption>
<colgroup>
<col width="18%" />
<col width="15%" />
<col width="13%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Department</th>
<th align="center">Male.Yes</th>
<th align="center">Male.No</th>
<th align="center">Female.Yes</th>
<th align="center">Female.No</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">512</td>
<td align="center">313</td>
<td align="center">89</td>
<td align="center">19</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">353</td>
<td align="center">207</td>
<td align="center">17</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">120</td>
<td align="center">205</td>
<td align="center">202</td>
<td align="center">391</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">138</td>
<td align="center">279</td>
<td align="center">131</td>
<td align="center">244</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">53</td>
<td align="center">138</td>
<td align="center">94</td>
<td align="center">299</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">22</td>
<td align="center">351</td>
<td align="center">24</td>
<td align="center">317</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dta$OR =<span class="st"> </span><span class="kw">with</span>(dta, (Male.Yes *<span class="st"> </span>Female.No) /<span class="st"> </span>(Male.No *<span class="st"> </span>Female.Yes))
dta$se =<span class="st"> </span><span class="kw">with</span>(dta, (<span class="kw">sqrt</span>(<span class="dv">1</span>/Male.Yes +<span class="st"> </span><span class="dv">1</span>/Female.No +<span class="st"> </span><span class="dv">1</span>/Male.No +<span class="st"> </span><span class="dv">1</span>/Female.Yes)))
dta$Conf.lwr =<span class="st"> </span><span class="kw">with</span>(dta, OR -<span class="st"> </span>(<span class="fl">1.96</span> *<span class="st"> </span>se))
dta$Conf.Upr =<span class="st"> </span><span class="kw">with</span>(dta, OR +<span class="st"> </span>(<span class="fl">1.96</span> *<span class="st"> </span>se))

<span class="kw">pandoc.table</span>(dta, <span class="dt">split.tables =</span> <span class="ot">Inf</span>)</code></pre></div>
<table>
<colgroup>
<col width="13%" />
<col width="11%" />
<col width="10%" />
<col width="13%" />
<col width="12%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Department</th>
<th align="center">Male.Yes</th>
<th align="center">Male.No</th>
<th align="center">Female.Yes</th>
<th align="center">Female.No</th>
<th align="center">OR</th>
<th align="center">se</th>
<th align="center">Conf.lwr</th>
<th align="center">Conf.Upr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">512</td>
<td align="center">313</td>
<td align="center">89</td>
<td align="center">19</td>
<td align="center">0.3492</td>
<td align="center">0.2627</td>
<td align="center">-0.1657</td>
<td align="center">0.8641</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">353</td>
<td align="center">207</td>
<td align="center">17</td>
<td align="center">8</td>
<td align="center">0.8025</td>
<td align="center">0.4376</td>
<td align="center">-0.05518</td>
<td align="center">1.66</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">120</td>
<td align="center">205</td>
<td align="center">202</td>
<td align="center">391</td>
<td align="center">1.133</td>
<td align="center">0.1439</td>
<td align="center">0.8509</td>
<td align="center">1.415</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">138</td>
<td align="center">279</td>
<td align="center">131</td>
<td align="center">244</td>
<td align="center">0.9213</td>
<td align="center">0.1502</td>
<td align="center">0.6269</td>
<td align="center">1.216</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">53</td>
<td align="center">138</td>
<td align="center">94</td>
<td align="center">299</td>
<td align="center">1.222</td>
<td align="center">0.2002</td>
<td align="center">0.8292</td>
<td align="center">1.614</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">22</td>
<td align="center">351</td>
<td align="center">24</td>
<td align="center">317</td>
<td align="center">0.8279</td>
<td align="center">0.3052</td>
<td align="center">0.2298</td>
<td align="center">1.426</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">marginal =<span class="st"> </span><span class="kw">colSums</span>(dta[, <span class="dv">2</span>:<span class="dv">5</span>])
OR =<span class="st"> </span>(marginal[<span class="dv">1</span>] *<span class="st"> </span>marginal[<span class="dv">4</span>]) /<span class="st"> </span>(marginal[<span class="dv">2</span>] *<span class="st"> </span>marginal[<span class="dv">3</span>])
se =<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span>/marginal[<span class="dv">1</span>] +<span class="st"> </span><span class="dv">1</span>/marginal[<span class="dv">4</span>] +<span class="st"> </span><span class="dv">1</span>/marginal[<span class="dv">2</span>] +<span class="st"> </span><span class="dv">1</span>/marginal[<span class="dv">3</span>])

## Confidence Interval for the Marginal OR
OR +<span class="st"> </span><span class="kw">c</span>(-<span class="dv">1</span>, <span class="dv">1</span>) *<span class="st"> </span><span class="fl">1.96</span> *<span class="st"> </span>se</code></pre></div>
<pre><code>[1] 1.71585 1.96631</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DescTools)
<span class="kw">library</span>(lawstat)

dta =<span class="st"> </span><span class="kw">xtabs</span>(freq ~<span class="st"> </span>.,
            <span class="kw">cbind</span>(<span class="kw">expand.grid</span>(<span class="dt">Gender =</span> <span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>),
                              <span class="dt">Entrace =</span> <span class="kw">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>),
                              <span class="dt">Department =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>)),
                  <span class="dt">freq =</span>  <span class="kw">c</span>(<span class="dv">512</span>, <span class="dv">89</span>, <span class="dv">313</span>, <span class="dv">19</span>, <span class="dv">353</span>, <span class="dv">17</span>, <span class="dv">207</span>, <span class="dv">8</span>, <span class="dv">120</span>, <span class="dv">202</span>, <span class="dv">205</span>, <span class="dv">391</span>,
                            <span class="dv">138</span>, <span class="dv">131</span>, <span class="dv">279</span>, <span class="dv">244</span>, <span class="dv">53</span>, <span class="dv">94</span>, <span class="dv">138</span>, <span class="dv">299</span>, <span class="dv">22</span>, <span class="dv">24</span>, <span class="dv">351</span>, <span class="dv">317</span>)
                  )
            )

## Ho: OR = 1, Ha: OR &gt; 1
<span class="kw">BreslowDayTest</span>(dta, <span class="dt">OR =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>
    Breslow-Day test on Homogeneity of Odds Ratios

data:  dta
X-squared = 19.938, df = 5, p-value = 0.001283</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Ho: OR_1 = OR_2 = OR_3 = OR_4 = OR_5 = OR_6, Ha: At least one set of OR are not equal
<span class="kw">cmh.test</span>(dta)</code></pre></div>
<pre><code>
    Cochran-Mantel-Haenszel Chi-square Test

data:  dta
CMH statistic = 1.52460, df = 1.00000, p-value = 0.21692, MH
Estimate = 0.90470, Pooled Odd Ratio = 1.84110, Odd Ratio of level
1 = 0.34921, Odd Ratio of level 2 = 0.80250, Odd Ratio of level 3
= 1.13310, Odd Ratio of level 4 = 0.92128, Odd Ratio of level 5 =
1.22160, Odd Ratio of level 6 = 0.82787</code></pre>
<p>Based on the Breslow Day test we reject the null hypothesis that the odds ratios are equal to 1. The CMH test fails to reject that gender and entrance are independent.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="me.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>


<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
