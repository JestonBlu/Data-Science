[
["index.html", "Welcome", " Welcome This website is a progress and intended to be a personal reference for data science related tasks. It consists of reproducible programming examples for various analytic and visualization techniques. In the sidebar menu, an icon next to each item identifies the source language used to create each example. All code is available on my Github project page. Feel free to connect with me on LinkedIn&lt; "],
["statistics-categorical.html", "Statistics: Categorical 0.1 Contingency Tables Logistic Regression", " Statistics: Categorical 0.1 Contingency Tables Data for applicant entrance for 6 departments Department Male.Yes Male.No Female.Yes Female.No 1 512 313 89 19 2 353 207 17 8 3 120 205 202 391 4 138 279 131 244 5 53 138 94 299 6 22 351 24 317 dta$OR = with(dta, (Male.Yes * Female.No) / (Male.No * Female.Yes)) dta$se = with(dta, (sqrt(1/Male.Yes + 1/Female.No + 1/Male.No + 1/Female.Yes))) dta$Conf.lwr = with(dta, OR - (1.96 * se)) dta$Conf.Upr = with(dta, OR + (1.96 * se)) pandoc.table(dta, split.tables = Inf) Department Male.Yes Male.No Female.Yes Female.No OR se Conf.lwr Conf.Upr 1 512 313 89 19 0.3492 0.2627 -0.1657 0.8641 2 353 207 17 8 0.8025 0.4376 -0.05518 1.66 3 120 205 202 391 1.133 0.1439 0.8509 1.415 4 138 279 131 244 0.9213 0.1502 0.6269 1.216 5 53 138 94 299 1.222 0.2002 0.8292 1.614 6 22 351 24 317 0.8279 0.3052 0.2298 1.426 marginal = colSums(dta[, 2:5]) OR = (marginal[1] * marginal[4]) / (marginal[2] * marginal[3]) se = sqrt(1/marginal[1] + 1/marginal[4] + 1/marginal[2] + 1/marginal[3]) ## Confidence Interval for the Marginal OR OR + c(-1, 1) * 1.96 * se [1] 1.71585 1.96631 library(DescTools) library(lawstat) dta = xtabs(freq ~ ., cbind(expand.grid(Gender = c(&quot;Male&quot;, &quot;Female&quot;), Entrace = c(&quot;Yes&quot;, &quot;No&quot;), Department = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;)), freq = c(512, 89, 313, 19, 353, 17, 207, 8, 120, 202, 205, 391, 138, 131, 279, 244, 53, 94, 138, 299, 22, 24, 351, 317) ) ) ## Ho: OR = 1, Ha: OR &gt; 1 BreslowDayTest(dta, OR = 1) Breslow-Day test on Homogeneity of Odds Ratios data: dta X-squared = 19.938, df = 5, p-value = 0.001283 ## Ho: OR_1 = OR_2 = OR_3 = OR_4 = OR_5 = OR_6, Ha: At least one set of OR are not equal cmh.test(dta) Cochran-Mantel-Haenszel Chi-square Test data: dta CMH statistic = 1.52460, df = 1.00000, p-value = 0.21692, MH Estimate = 0.90470, Pooled Odd Ratio = 1.84110, Odd Ratio of level 1 = 0.34921, Odd Ratio of level 2 = 0.80250, Odd Ratio of level 3 = 1.13310, Odd Ratio of level 4 = 0.92128, Odd Ratio of level 5 = 1.22160, Odd Ratio of level 6 = 0.82787 Based on the Breslow Day test we reject the null hypothesis that the odds ratios are equal to 1. The CMH test fails to reject that gender and entrance are independent. Logistic Regression Data Background NAME: Prostate Cancer Study (PCS.DATA) SIZE: 380 observations, 9 variables SOURCE: Hosmer and Lemeshow (2000) Applied Logistic Regression: Second Edition. These data are copyrighted by John Wiley &amp; Sons Inc. and must be acknowledged and used accordingly. DESCRIPTIVE ABSTRACT: These data are described in Section 1.6.3 page 25, of the source text. LIST OF VARIABLES: 1 Identification Code: 1 - 380 2 Tumor Penetration of Prostatic Capsule: 0 = No Penetration, 1 = Penetration 3 Age: Years 4 Race: 1= White, 2 = Black 5 Results of the Digital Rectal Exam: 1 = No Nodule, 2 = Unilobar Nodule (Left), 3 = Unilobar Nodule (Right), 4 = Bilobar Nodule 6 Detection of Capsular Involvement in Rectal Exam: 1 = No, 2 = Yes 7 Prostatic Specific Antigen Value: mg/ml 8 Tumor Volume Obtained from Ultrasound: cm3 9 Total Gleason Score: 0 - 10 library(popbio) library(Deducer) dta = read.csv(&quot;Statistics/Categorical/data/pros.csv&quot;) head(dta) ID CAPSULE AGE RACE DPROS DCAPS PSA VOL GLEASON 1 1 0 65 1 2 1 1.4 0.0 6 2 2 0 72 1 3 2 6.7 0.0 7 3 3 0 70 1 1 2 4.9 0.0 6 4 4 0 76 2 2 1 51.2 20.0 7 5 5 0 69 1 1 1 12.3 55.9 6 6 6 1 71 1 3 2 3.3 0.0 8 mdl = glm(CAPSULE ~ AGE + RACE + DPROS + DCAPS + PSA + VOL + GLEASON, family = binomial(), data = dta) summary(mdl) Call: glm(formula = CAPSULE ~ AGE + RACE + DPROS + DCAPS + PSA + VOL + GLEASON, family = binomial(), data = dta) Deviance Residuals: Min 1Q Median 3Q Max -2.4058 -0.7772 -0.4416 0.9019 2.3771 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -6.915650 1.728754 -4.000 6.32e-05 *** AGE -0.015825 0.019517 -0.811 0.41745 RACE -0.695258 0.476106 -1.460 0.14421 DPROS 0.551597 0.136545 4.040 5.35e-05 *** DCAPS 0.479916 0.463728 1.035 0.30071 PSA 0.027196 0.009922 2.741 0.00613 ** VOL -0.010840 0.007753 -1.398 0.16204 GLEASON 0.972442 0.167259 5.814 6.10e-09 *** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 506.59 on 375 degrees of freedom Residual deviance: 377.31 on 368 degrees of freedom (4 observations deleted due to missingness) AIC: 393.31 Number of Fisher Scoring iterations: 5 logi.hist.plot(sqrt(dta$PSA), dta$CAPSULE, logi.mod = 1, boxp = FALSE, notch = FALSE, main = &quot;Logistic Regression plot for PSA&quot;, xlab = &quot;PSA&quot;) rocplot(mdl) "]
]
